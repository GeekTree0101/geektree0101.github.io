<!doctype html><html>
<head>
<title>Flask사용하면서 느낀점 정리 #1 // Geektree0101</title>
<meta charset=utf-8>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<meta name=description content="내가 Flask 를 최근에 많이 가지고 논 이유는 다음과 같다.">
<meta property="og:title" content="Flask사용하면서 느낀점 정리 #1">
<meta property="og:description" content>
<meta property="og:type" content="website">
<meta property="og:locale" content="en">
<meta property="og:url" content="/blog/2018-11-04_flask-1-40f90541f71/">
<link rel="shortcut icon" href=/favicon.ico>
<link href=/webfonts/ptserif/main.css rel=stylesheet type=text/css>
<link href=/webfonts/source-code-pro/main.css rel=stylesheet type=text/css>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=/css/article-toc.css type=text/css>
<meta name=generator content="Hugo 0.91.2">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3090955890879034" crossorigin=anonymous></script>
</head>
<body>
<div id=container>
<header id=header>
<div id=header-outer class=outer>
<div id=header-inner class=inner>
<a id=main-nav-toggle class=nav-icon href=javascript:;></a>
<a id=logo class=logo-text href=/>Geektree0101</a>
<nav id=main-nav>
<a class=main-nav-link href=/about>About</a>
<a class=main-nav-link href=/categories>Categories</a>
<a class=main-nav-link href=/tags>Tags</a>
</nav>
<nav id=sub-nav>
<div id=search-form-wrap>
</div>
</nav>
</div>
</div>
</header>
<section id=main class=outer>
<article class="article article-type-post" itemscope itemprop=blogPost>
<div class=article-inner>
<header class=article-header>
<h1 class=article-title itemprop=name>Flask사용하면서 느낀점 정리 #1</h1>
</header>
<div class=article-meta>
<a href=/blog/2018-11-04_flask-1-40f90541f71/ class=article-date>
<time datetime=2018-11-04T07:31:23.464+00:00 itemprop=datePublished>2018-11-04</time>
</a>
<div class=post-categories>
<div class=article-category>
<a class=article-category-link href=/categories/server>Server</a>
</div>
</div>
<div class=article-comment-link-wrap>
<a href=/blog/2018-11-04_flask-1-40f90541f71/#disqus_thread class=article-comment-link>Comments</a>
</div>
</div>
<div class=article-entry itemprop=articleBody>
<p><img src=/images/blog/1__4__iwzhEuTi8Cm83ueft7LA.png alt></p>
<p>내가 Flask 를 최근에 많이 가지고 논 이유는 다음과 같다.</p>
<ul>
<li>코드 많이 쓰기 <strong>귀찮아서</strong></li>
<li>간만에 Node로 때우자니 이전에 사용했던 경험 되살리기 <strong>귀찮아서</strong></li>
<li>Xcode랑 AppCode빼고 남아있는게 PyCharm 밖에 없고 vscode사용하자니 내 입맛대로 셋팅하자니 <strong>귀찮아서</strong></li>
</ul>
<p>그냥 귀찮아서…</p>
<p>용불용설이라고… 했던거 한동안 안하면 까먹거나 가물가물한다.</p>
<p>요즘엔 AWS가 핫하지 않습니꽈, 특히 lambda (회사 생활하면서 주로 간접적으로 체감했던거라)</p>
<p>그리고 dynamoDB, 솔직히 이번 포스팅하면서 첨 접하는거라 약간의 룰정도만 익히고 PynamoDB를 씁니다.</p>
<p><a href=https://github.com/pynamodb/PynamoDB title=https://github.com/pynamodb/PynamoDB><strong>pynamodb/PynamoDB</strong><br>
_A pythonic interface to Amazon&rsquo;s DynamoDB. Contribute to pynamodb/PynamoDB development by creating an account on…_github.com</a><a href=https://github.com/pynamodb/PynamoDB></a></p>
<p>참 잘만든 라이브러리인거 같습니다. 언능 star 1,000 달성하길 기원합니다.</p>
<p>우선 Model 대충 맹글어봅시다.</p>
<p>from pynamodb.models import Model<br>
from pynamodb.attributes import (<br>
NumberAttribute,<br>
UnicodeAttribute<br>
)</p>
<p>class User(Model):</p>
<pre><code>class Meta:  
    table\_name = 'User'  
    read\_capacity\_units = 1  
    write\_capacity\_units = 1  
    host = &quot;http://localhost:8000&quot;  

id = NumberAttribute(hash\_key=True)  
username = UnicodeAttribute()  
bio = UnicodeAttribute()
</code></pre>
<p>역시 귀찮아서 저는 Local DB를 사용하겠습니다. Table이름과 read_capacity, write_capacity를 Meta에 define해주고 제가 사용하고자 하는 property 들을 작성해줍니다. (id/username/bio)</p>
<p>대충 user.json 만들어서 seed 때려줍니다. 그리고 user API가 있는 user_service blue print는 app객체에 register_blueprint해줍니다.</p>
<p>from flask import Flask<br>
from user_service import user_service<br>
import db</p>
<p>app = Flask(__name__)<br>
db.seed() &lt;&ndash; 여기<br>
app.register_blueprint(user_service)</p>
<p>if __name__ == &ldquo;__main__":<br>
app.run()</p>
<p>bluePrint쓰는건 체계적으로 설계하기 위함입니다. 한 페이지에 API 로직 다 때려박는건 저도 원치않습니다. 아무리 귀찮아도 blueprint를 써야겠습니다.</p>
<p>user_service.py 에 대충 GET user/{id} 만 대충맹글어봅니다.</p>
<p>from flask import Blueprint, make_response, jsonify, request<br>
from models.user import User</p>
<p>user_service = Blueprint(&ldquo;users&rdquo;, __name__, url_prefix="/users&rdquo;)</p>
<p>@user_service.route("/<a href=int:id>int:id</a>", methods=[&ldquo;GET&rdquo;])<br>
def get_user(id: int):<br>
user: User</p>
<pre><code>try:  
    user = User.get(id)  
except User.DoesNotExist:  
    return make\_response(&quot;Not Found&quot;, 404)  

res\_obj = {  
    &quot;data&quot;: {  
        &quot;username&quot;: user.username,  
        &quot;bio&quot;: user.bio  
    }  
}  
return make\_response(jsonify(res\_obj), 200)
</code></pre>
<p>data object로 처리하는 이유는 나중에 after key를 추가해서 user list pagination 를 만들기 위해서입니다. (솔직히 Vingle 백엔드 개발자분들 이런거 뚝딱 만들어 내는거 보면 자랑스럽습니다.)</p>
<p><img src=/images/blog/1__tngd1yo__NW9mOoAIpEneRg.jpeg alt></p>
<p>파잘개(파이썬 잘아는 개발자)님들에게는 제 코드가 마치 뭔가 냄새나는 코드같겠지만, <strong>“아 글쓴분 iOS 개발자지”</strong> 하고 대충 그려려니 이해해줍시다.</p>
<p>한번 대충 Postman으로 GET 때려봅시다.</p>
<p><img src=/images/blog/1__6YQZyoMvkp__NXnb14N__7KA.png alt></p>
<p>사실 어제 술을 많이마셔서 만사가 귀찮은데도 여기까지 한 제 자신을 보고 박수라도 쳐주고 싶었습니다.</p>
<p>시작이 반 아니겠습니까.</p>
<p>대충 Pagination도 구현해봅시다.</p>
<p>@user_service.route("/list", methods=[&ldquo;GET&rdquo;])<br>
def get_user_list():</p>
<p>API는 GET users/list 으로 정의하겠습니다.</p>
<p>그리고 DynamoDB Docs에서 대충 제눈에 들어오는게 <strong>last_evaluated_key</strong> 가 보이는군요 이걸 after key의 value로 넣으면 되지않을까 생각하고 대충 만들어서 API를 호출해봅니다.</p>
<p><img src=/images/blog/1__ENgP4z2l6yHyelXRzm____Uw.png alt>
<img src=/images/blog/1__zRbZRuyMoxKdD72BP43crg.png alt></p>
<p>뭔가 엉성하지만 제가 원하는 느낌으로 연출되는거 같습니다.</p>
<p>자세한건 <a href=https://github.com/pynamodb/PynamoDB/issues/248>https://github.com/pynamodb/PynamoDB/issues/248</a></p>
<p>상단 issue에 많은 PynamoDB 팬 분들이 자세히?토론을 해주셔서 저 또한 도움 잘받은거 같습니다.</p>
<p>숙취해소 되고나면 느낌점 #2로 돌아오겠습니다.</p>
<p>(주의: 맘 변심해서 안돌아 올수도 있음)</p>
<p>example source code:</p>
<p><a href=https://gist.github.com/GeekTree0101/4005bfd63a1dab7f9a5f3039cf50075f>https://gist.github.com/GeekTree0101/4005bfd63a1dab7f9a5f3039cf50075f</a></p>
</div>
<div class=article-toc>
<h3>Contents</h3>
<nav id=TableOfContents></nav>
</div>
<footer class=article-footer>
<ul class=article-tag-list>
<li class=article-tag-list-item>
<a class=article-tag-list-link href=tags/python>python
</a>
</li>
<li class=article-tag-list-item>
<a class=article-tag-list-link href=tags/flask>flask
</a>
</li>
</ul>
</footer>
</div>
<nav id=article-nav>
<a href=/blog/2018-11-10_floating-uisearchbar-best-practice-with-texture-asyncdisplaykit-9978a662982d/ id=article-nav-newer class=article-nav-link-wrap>
<div class=article-nav-title><span>&lt;</span>&nbsp;
Floating UISearchBar best practice with Texture(AsyncDisplayKit)
</div>
</a>
<a href=/blog/2018-10-28_-ios-let-s-tracking-visible-cell-on-scrollview-7f40922f1165/ id=article-nav-older class=article-nav-link-wrap>
<div class=article-nav-title>[iOS] Let’s Tracking Visible Cell on ScrollView&nbsp;<span>></span></div>
</a>
</nav>
</article>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//https-geektree0101-github-io.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</section>
<footer id=footer>
<div class=outer>
<div id=footer-info class=inner>
&copy; 2022 Geektree0101
<br>
Powered by <a href=https://gohugo.io target=_blank>Hugo</a> with theme <a href=https://github.com/carsonip/hugo-theme-minos target=_blank>Minos</a>
</div>
</div>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin=anonymous>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin=anonymous></script>
<script>hljs.initHighlightingOnLoad()</script>
<script>document.getElementById('main-nav-toggle').addEventListener('click',function(){var a=document.getElementById('header');a.classList.contains('mobile-on')?a.classList.remove('mobile-on'):a.classList.add('mobile-on')})</script>
</footer>
</div>
</body>
</html>